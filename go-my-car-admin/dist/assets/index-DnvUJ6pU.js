import{y as O,z as T,A as w,r as n,j as t,I as R,D as Y,E as x,B as F,T as M}from"./index-CiOuKirm.js";import{P as _,D as H,C as q,A as K}from"./index-K4TRuiv_.js";import{a as $}from"./useUsers-Dtt3s6e2.js";import{d as h}from"./dayjs.min-7BedNc8G.js";const L=T,V={COUPONS:`${L}/api`},z=async c=>O("get",`${V.COUPONS}/getAllBooking`,null,{params:c}),G=c=>w({queryKey:[c],queryFn:()=>z(c)}),ee=()=>{const[c,p]=n.useState([]),[d,f]=n.useState(""),[v,Q]=n.useState(""),[o,i]=n.useState({page:1,limit:10,totalPages:null,totalDocs:null});console.log("pagination",o);const{data:l,isPending:y,isError:D,isSuccess:j,refetch:g}=G({limit:o.limit,page:o.page,search:d});console.log("apiResponse",l);const A=e=>{M("success",(e==null?void 0:e.message)||"Booking created successfully")},{mutate:C,isSuccess:S}=$(A);n.useEffect(()=>{if(l){const{data:e}=l,{page:s,limit:a,totalPages:r,totalDocs:m}=e;console.log("Data?.docs",e),console.log("page",s),console.log("limit",a),console.log("totalPages",r),console.log("totalDocs",m),p(e.docs),i({page:s,limit:a,totalPages:r,totalDocs:m})}},[l]),n.useEffect(()=>{g()},[o.page,o.limit,g,S]);const N=e=>{i(s=>({...s,page:e}))},U=e=>{f(e),i(s=>({...s,page:1}))},u=e=>{const s={userId:v,isActive:e};C(s),console.log("Payload:>>",s)};console.log("data",c);const[b,P]=n.useState(!1),[E,I]=n.useState(!1),k=[{accessorKey:"_id",header:({column:e})=>t.jsxs(F,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:["ID",t.jsx(K,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>t.jsx("div",{children:t.jsx(q,{text:e.getValue("_id")})})},{accessorFn:e=>{var s;return(s=e.user)==null?void 0:s.fullName},id:"fullName",header:"Full Name",cell:({getValue:e})=>t.jsx("div",{children:e()})},{accessorFn:e=>e.user,id:"email",header:"Email",cell:({row:e})=>{var s;return console.log("Row data:",e.original),t.jsx("div",{children:((s=e.original.user)==null?void 0:s.email)||"No Email"})}},{accessorFn:e=>e.car,id:"carname",header:"Car Name",cell:({row:e})=>{var s;return console.log("Row data:",e.original),t.jsx("div",{children:((s=e.original.car)==null?void 0:s.carName)||"No Car Name"})}},{accessorFn:e=>e.car,id:"startDate",header:"Start Date",cell:({row:e})=>{var r;const s=(r=e.original.car)==null?void 0:r.startDate,a=s?h(s).format("DD MMM YYYY, hh:mm A"):"No start date";return t.jsx("div",{children:a})}},{accessorFn:e=>e.car,id:"endDate",header:"End Date",cell:({row:e})=>{var r;const s=(r=e.original.car)==null?void 0:r.endDate,a=s?h(s).format("DD MMM YYYY, hh:mm A"):"No endDate date";return t.jsx("div",{children:a})}},{accessorKey:"status",header:"Status",cell:({row:e})=>{const s=e.getValue("status");let a="";switch(s){case"Pending":a="bg-yellow-100 text-yellow-800";break;case"Completed":a="bg-green-100 text-green-800";break;case"Cancelled":a="bg-red-100 text-red-800";break;default:a="bg-gray-100 text-gray-800";break}return t.jsx("span",{className:`px-2 py-1 rounded text-sm font-medium ${a}`,children:s})}}],B=[];return t.jsxs("div",{children:[t.jsx(_,{title:"Bookings"}),t.jsxs("div",{className:"border rounded-xl p-4 flex flex-start flex-col min-h-[700px] ",children:[D&&t.jsx("div",{className:"flex flex-1 items-center justify-center",children:t.jsx("p",{className:"text-red-500",children:"Error fetching data"})}),t.jsx(R,{placeholder:"Search Bookings by fullName",value:d,onChange:e=>U(e.target.value),className:"max-w-sm"}),y&&t.jsx("div",{className:"h-[700px]",children:t.jsx(Y,{})}),j&&t.jsx(H,{data:c,columns:k,filters:B,page:o==null?void 0:o.page,totalPages:o==null?void 0:o.totalPages,onPageChange:N})]}),t.jsx(x,{title:"Are you sure you want Active this User?",description:"",confirmText:"Activate User",cancelText:"Cancel",onConfirm:()=>u(!0),confirmButtonClass:"bg-primary  hover:bg-primary-600",open:E,setOpen:I}),t.jsx(x,{title:"Are you sure you want In Active this User?",description:"",confirmText:"InActive User",cancelText:"Cancel",onConfirm:()=>u(!1),confirmButtonClass:"bg-destructive text-white hover:bg-red-600",open:b,setOpen:P})]})};export{ee as default};
