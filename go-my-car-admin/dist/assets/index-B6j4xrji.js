import{r,j as s,I as S,a as C,B as w,G as D}from"./index-CiOuKirm.js";import{P as V,D as E,C as K,A as I}from"./index-K4TRuiv_.js";import{u as F}from"./useTableFilters-CQ-XPJR7.js";import{u as T}from"./index-yYWyrP8g.js";const B=()=>{const[m,h]=r.useState([]),[a,i]=r.useState({page:1,limit:10,totalPages:null,totalDocs:null}),c=[],{search:o,searchInput:p,searchQueryParams:n,handleSearchChange:u,handleFilterChange:g}=F(c,a,i),{data:t,isPending:x,isError:f,isSuccess:j,refetch:d}=T({limit:a.limit,page:a.page,search:o,...n});r.useEffect(()=>{if(console.log("apiResponse",t),t){const{data:e}=t,{page:l,limit:y,totalPages:b,totalDocs:P}=e;console.log(e,"data"),h(e==null?void 0:e.docs),i({page:l,limit:y,totalPages:b,totalDocs:P})}},[t]),r.useEffect(()=>{d()},[a.page,a.limit,d,o,n]);const v=e=>i(l=>({...l,page:e})),N=[{accessorKey:"_id",header:({column:e})=>s.jsxs(w,{variant:"ghost",onClick:()=>e.toggleSorting(e.getIsSorted()==="asc"),children:["ID",s.jsx(I,{className:"ml-2 h-4 w-4"})]}),cell:({row:e})=>s.jsx("div",{children:s.jsx(K,{text:e.getValue("_id")})})},{accessorKey:"email",header:"email",cell:({row:e})=>s.jsx("div",{children:e.getValue("email")})},{accessorKey:"fullName",header:"Full Name",cell:({row:e})=>s.jsx("div",{children:e.getValue("fullName")})},{accessorKey:"phoneNumber",header:"Phone Number",cell:({row:e})=>s.jsx("div",{children:e.getValue("phoneNumber")}),visible:!1},{accessorKey:"comment",header:"comment",cell:({row:e})=>s.jsx("div",{children:e.getValue("comment")}),visible:!1},{accessorKey:"reply",header:"Status",cell:({row:e})=>{const l=e.getValue("reply");return s.jsx("div",{children:l?"Completed":"Pending"})}},{id:"actions",enableHiding:!1,cell:({row:e})=>s.jsx("div",{className:"flex w-full gap-2",children:s.jsx(D,{to:`/support/view/${e.original._id}`,className:"hover:underline",children:"View"})})}];return s.jsxs("div",{children:[s.jsx(V,{title:"Supports"}),s.jsxs("div",{className:"border rounded-xl p-4 flex flex-col min-h-[700px]",children:[s.jsx("div",{className:"flex justify-between mb-4 gap-2",children:s.jsx("div",{className:"grid grid-cols-2 gap-3 flex-1",children:s.jsx(S,{placeholder:"Search Supports by email",value:p,onChange:e=>u(e.target.value),className:"max-w-sm"})})}),x&&s.jsx("div",{className:"h-[600px] flex items-center justify-center",children:s.jsx(C,{className:"mr-2 h-10 w-10 animate-spin"})}),f&&s.jsx("div",{className:"flex flex-1 items-center justify-center",children:s.jsx("p",{className:"text-red-500",children:"Error fetching support data"})}),j&&s.jsx(E,{data:m,columns:N,filters:c,page:a==null?void 0:a.page,totalPages:a==null?void 0:a.totalPages,onPageChange:v,handleFilter:g})]})]})};export{B as default};
